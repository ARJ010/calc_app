{% extends 'base.html' %}

{% block content %}
    <h2>Payment History</h2>
    
    <!-- Filter form -->
    <form method="get">
        <label for="month">Month:</label>
        <select name="month" id="month">
            <option value="">--All Months--</option>
            {% for month in distinct_months %}
                <option value="{{ month }}" {% if selected_month == month %}selected{% endif %}>{{ month }}</option>
            {% endfor %}
        </select>
        
        <label for="year">Year:</label>
        <select name="year" id="year">
            <option value="">--All Years--</option>
            {% for year in distinct_years %}
                <option value="{{ year }}" {% if selected_year == year %}selected{% endif %}>{{ year }}</option>
            {% endfor %}
        </select>
        
        <label for="payment_status">Payment Status:</label>
        <select name="payment_status" id="payment_status">
            <option value="">--All--</option>
            <option value="paid" {% if payment_status == 'paid' %}selected{% endif %}>Paid</option>
            <option value="not_paid" {% if payment_status == 'not_paid' %}selected{% endif %}>Not Paid</option>
        </select>

        <button type="submit">Filter</button>
    </form>

    <!-- Payment History Table -->
    <table>
        <thead>
            <tr>
                <th>Advocate</th>
                <th>Amount</th>
                <th>Month/Year</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            {% for payment in payments %}
                <tr>
                    <td>{{ payment.advocate.user.first_name }} {{ payment.advocate.user.last_name }}</td>
                    <td>â‚¹{{ payment.amount }}</td>
                    <td>{{ payment.month }}/{{ payment.year }}</td>
                    <td>{% if payment.amount > 0 %}Paid{% else %}Not Paid{% endif %}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

{% endblock %}
